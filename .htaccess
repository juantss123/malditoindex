# DentexaPro - URLs limpias y profesionales
# Configuración Apache para reescritura de URLs

RewriteEngine On

# Forzar HTTPS (opcional - descomenta si tienes SSL)
# RewriteCond %{HTTPS} off
# RewriteRule ^(.*)$ https://%{HTTP_HOST}%{REQUEST_URI} [L,R=301]

# Remover extensión .php de las URLs
RewriteCond %{REQUEST_FILENAME} !-d
RewriteCond %{REQUEST_FILENAME} !-f
RewriteRule ^([^\.]+)$ $1.php [NC,L]

# URLs específicas para páginas principales
RewriteRule ^inicio/?$ index.php [NC,L]
RewriteRule ^home/?$ index.php [NC,L]
RewriteRule ^login/?$ login.php [NC,L]
RewriteRule ^registro/?$ registro.php [NC,L]
RewriteRule ^dashboard/?$ dashboard.php [NC,L]
RewriteRule ^panel/?$ dashboard.php [NC,L]

# URLs para páginas de administración
RewriteRule ^admin/?$ admin.php [NC,L]
RewriteRule ^admin/usuarios/?$ admin-usuarios.php [NC,L]
RewriteRule ^admin/configuracion/?$ admin-configuracion.php [NC,L]
RewriteRule ^admin/suscripciones/?$ admin-suscripciones.php [NC,L]
RewriteRule ^admin/facturas/?$ admin-facturas.php [NC,L]
RewriteRule ^admin/comprobantes/?$ admin-comprobantes.php [NC,L]
RewriteRule ^admin/tickets/?$ admin-tickets.php [NC,L]
RewriteRule ^admin/soporte/?$ admin-tickets.php [NC,L]
RewriteRule ^admin/blog/?$ admin-blog.php [NC,L]
RewriteRule ^admin/newsletter/?$ admin-newsletter.php [NC,L]
RewriteRule ^admin/marketing/?$ admin-marketing.php [NC,L]
RewriteRule ^admin/analiticas/?$ admin-analiticas.php [NC,L]

# URLs para blog
RewriteRule ^blog/?$ blog.php [NC,L]
RewriteRule ^blog/([^/]+)/?$ blog-post.php?slug=$1 [NC,L]

# URLs para páginas legales
RewriteRule ^terminos/?$ terminos-condiciones.php [NC,L]
RewriteRule ^privacidad/?$ politica-privacidad.php [NC,L]
RewriteRule ^guia/?$ guia-usuario.php [NC,L]
RewriteRule ^ayuda/?$ guia-usuario.php [NC,L]

# URLs para procesos de pago
RewriteRule ^pago/([^/]+)/?$ pago.php?plan=$1 [NC,L]
RewriteRule ^payment/([^/]+)/?$ pago.php?plan=$1 [NC,L]

# URLs para recuperación de contraseña
RewriteRule ^recuperar/?$ forgot-password.php [NC,L]
RewriteRule ^reset/?$ reset-password.php [NC,L]

# Redirecciones para compatibilidad
RewriteRule ^salir/?$ logout.php [NC,L]
RewriteRule ^cerrar-sesion/?$ logout.php [NC,L]

# Proteger archivos sensibles
<Files "*.sql">
    Order allow,deny
    Deny from all
</Files>

<Files "config/*">
    Order allow,deny
    Deny from all
</Files>

# Proteger archivos de configuración
RewriteRule ^config/ - [F,L]
RewriteRule ^database/ - [F,L]
RewriteRule ^\.env - [F,L]

# Optimizaciones de rendimiento
<IfModule mod_expires.c>
    ExpiresActive On
    ExpiresByType text/css "access plus 1 month"
    ExpiresByType application/javascript "access plus 1 month"
    ExpiresByType image/png "access plus 1 month"
    ExpiresByType image/jpg "access plus 1 month"
    ExpiresByType image/jpeg "access plus 1 month"
    ExpiresByType image/gif "access plus 1 month"
    ExpiresByType image/svg+xml "access plus 1 month"
</IfModule>

# Compresión GZIP
<IfModule mod_deflate.c>
    AddOutputFilterByType DEFLATE text/plain
    AddOutputFilterByType DEFLATE text/html
    AddOutputFilterByType DEFLATE text/xml
    AddOutputFilterByType DEFLATE text/css
    AddOutputFilterByType DEFLATE application/xml
    AddOutputFilterByType DEFLATE application/xhtml+xml
    AddOutputFilterByType DEFLATE application/rss+xml
    AddOutputFilterByType DEFLATE application/javascript
    AddOutputFilterByType DEFLATE application/x-javascript
</IfModule>

# Headers de seguridad
<IfModule mod_headers.c>
    Header always set X-Content-Type-Options nosniff
    Header always set X-Frame-Options DENY
    Header always set X-XSS-Protection "1; mode=block"
    Header always set Referrer-Policy "strict-origin-when-cross-origin"
</IfModule>